(()=>{"use strict";var t={870:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Drawing=void 0;const i=s(212),a=s(663),o=s(327),n=s(601),r=s(646),c=s(44),l=s(909),h=s(718);e.Drawing=class{constructor(){this.draw=t=>this.tool.addPoint(l.Mouse.getPosition(t)),this.canvas=new i.Canvas,this.tool=n.NullTool.Instance,c.Control.setupListeners(),this.appendListeners()}static get Instance(){return this._instance||(this._instance=new this)}appendListeners(){window.addEventListener("pointerdown",(t=>{c.Control.isControlElem(t.target)||(this.tool=this.chooseTool(r.BoardStorage.get("tool"),h.Properties.local),this.tool.startDraw(l.Mouse.getPosition(t)),window.addEventListener("pointermove",this.draw,!1))}),!1),window.addEventListener("pointerup",(()=>{window.removeEventListener("pointermove",this.draw,!1),this.tool.endDraw(),this.tool=n.NullTool.Instance}),!1)}chooseTool(t,e){switch(t){case"brush":return new a.Brush(this.canvas,e);case"eraser":return new o.Eraser(this.canvas,e);default:return n.NullTool.Instance}}}},212:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Canvas=void 0;const i=s(426);e.Canvas=class{constructor(){this._canvas=document.createElement("canvas"),this._canvas.width=window.screen.availWidth,this._canvas.height=window.screen.availHeight,this._ctx=this._canvas.getContext("2d"),this.setProperties(),document.body.appendChild(this._canvas)}setProperties(){this.ctx.lineJoin=i.Config.lineJoin,this.ctx.lineCap=i.Config.lineCap}setColor(t){this._ctx.strokeStyle=t,this._ctx.fillStyle=t}setLineWidth(t){this._ctx.lineWidth=t}clear(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height)}get canvas(){return this._canvas}get ctx(){return this._ctx}}},426:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Config=void 0,e.Config={lineJoin:"round",lineCap:"round",canDraw:!1}},466:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MainCanvas=void 0;const i=s(212),a=s(646);class o extends i.Canvas{constructor(){super(),this.drawWhiteBackground(),this.drawFromStorage(),this.sendToBack()}static get Instance(){return this._instance||(this._instance=new this)}drawFromStorage(){let t=a.BoardStorage.get("img");if(!t)return;let e=new Image;e.src=t,e.addEventListener("load",(()=>this.ctx.drawImage(e,0,0)))}drawWhiteBackground(){let t=this.ctx.fillStyle;this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle=t}sendToBack(){this.canvas.style.zIndex="-1000"}drawImage(t){this.ctx.drawImage(t,0,0)}saveInStorage(){let t=this.getImgSrc();a.BoardStorage.set("img",t)}getImgSrc(){let t=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height);return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.putImageData(t,0,0),this.canvas.toDataURL("image/png")}}e.MainCanvas=o},663:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Brush=void 0;const i=s(397);class a extends i.Tool{prepare(){this.canvas.setColor(this.properties.color),this.canvas.setLineWidth(this.properties.lineWidth)}}e.Brush=a},327:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Eraser=void 0;const i=s(397);class a extends i.Tool{prepare(){this.canvas.setColor("#ffffff"),this.canvas.setLineWidth(this.properties.lineWidth)}}e.Eraser=a},601:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullTool=void 0;const i=s(718),a=s(397);class o extends a.Tool{constructor(){super({},i.Properties.local)}static get Instance(){return this._instance||(this._instance=new this)}addPoint(){}startDraw(){}endDraw(){}prepare(){}}e.NullTool=o},397:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Tool=void 0;const i=s(466);e.Tool=class{constructor(t,e){this.canvas=t,this.properties=e,this.points=[]}addPoint(t){this.points.push(t),this.draw()}startDraw(t){this.prepare(),this.addPoint(t)}draw(){if(this.points.length<3){let t=this.points[0];return this.canvas.ctx.beginPath(),this.canvas.ctx.arc(t.x,t.y,this.canvas.ctx.lineWidth/2,0,2*Math.PI,!0),this.canvas.ctx.fill(),void this.canvas.ctx.closePath()}this.canvas.ctx.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.canvas.ctx.beginPath(),this.canvas.ctx.moveTo(this.points[0].x,this.points[0].y);for(let t=1;t<this.points.length-2;t++){let e=(this.points[t].x+this.points[t+1].x)/2,s=(this.points[t].y+this.points[t+1].y)/2;this.canvas.ctx.quadraticCurveTo(this.points[t].x,this.points[t].y,e,s)}let t=this.points.length-2;this.canvas.ctx.quadraticCurveTo(this.points[t].x,this.points[t].y,this.points[t+1].x,this.points[t+1].y),this.canvas.ctx.stroke()}endDraw(){i.MainCanvas.Instance.drawImage(this.canvas.canvas),i.MainCanvas.Instance.saveInStorage(),this.canvas.clear()}}},646:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BoardStorage=void 0;const i=s(392);e.BoardStorage=class{static set(t,e){"object"!=typeof e&&sessionStorage.setItem(t,e),e=JSON.stringify(e),sessionStorage.setItem(t,e)}static get(t){let e=sessionStorage.getItem(t);return i.Valid.isJSON(e)?JSON.parse(e):e}}},44:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Control=void 0;const i=s(646);class a{static isControlElem(t){let e=!1;return Array.from(this.tools.children).forEach((s=>{s.className!=t.className||(e=!0)})),e||t.className==this.colorOutput.className||t.className==this.colorInput.className||t.className==this.lineWidthInput.className||t.className==this.lineWidthOutput.className||t.className==this.download.className}static setupListeners(){this.lineWidthInput.addEventListener("input",(t=>this.setLineWidth(+t.target.value))),this.colorInput.addEventListener("input",(t=>this.setColor(t.target.value))),this.tools.addEventListener("click",(t=>this.setTool(t.target.className))),this.download.addEventListener("click",(()=>this.downloadImage()))}static setColor(t){i.BoardStorage.set("color",t),this.colorOutput.style.backgroundColor=t}static setLineWidth(t){i.BoardStorage.set("lineWidth",t.toString()),this.lineWidthOutput.value=t.toString(),this.lineWidthInput.value=t.toString()}static setTool(t){"tools"!=t&&i.BoardStorage.set("tool",t)}static downloadImage(){let t=i.BoardStorage.get("img");this.download.href=t}}e.Control=a,a.colorOutput=document.getElementsByClassName("color-label-element")[0],a.colorInput=document.getElementsByClassName("color")[0],a.lineWidthOutput=document.getElementsByClassName("paint-size-out")[0],a.lineWidthInput=document.getElementsByClassName("paint-size-in")[0],a.tools=document.getElementsByClassName("tools")[0],a.download=document.getElementsByClassName("download")[0]},909:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Mouse=void 0;const i=s(967);e.Mouse=class{static getPosition(t){return new i.Point(t.pageX,t.pageY)}static setCursorStyle(t){document.body.style.cursor=t}}},967:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Point=void 0,e.Point=class{constructor(t,e){this._x=t,this._y=e}get x(){return this._x}get y(){return this._y}}},718:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Properties=void 0;const i=s(646);e.Properties=class{constructor(t,e){this._lineWidth=t,this._color=e}static get local(){return new this(+i.BoardStorage.get("lineWidth"),i.BoardStorage.get("color"))}get lineWidth(){return this._lineWidth}get color(){return this._color}}},392:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Valid=void 0,e.Valid=class{static isJSON(t){try{JSON.parse(t)}catch(t){return!1}return!0}}}},e={};function s(i){var a=e[i];if(void 0!==a)return a.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,s),o.exports}(()=>{const t=s(870),e=s(466),i=s(646),a=s(44);(class{static run(){this.setupConfig(),e.MainCanvas.Instance,t.Drawing.Instance}static setupConfig(){a.Control.setColor(i.BoardStorage.get("color")||"#000000"),a.Control.setLineWidth(i.BoardStorage.get("lineWidth")||10),a.Control.setTool(i.BoardStorage.get("tool")||"brush")}}).run()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBRWYsTUFBT2hKLEdBQ0gsT0FBTyxFQUVYLE9BQU8sTUNWWGlKLEVBQTJCLEdBRy9CLFNBQVNDLEVBQW9CQyxHQUU1QixJQUFJQyxFQUFlSCxFQUF5QkUsR0FDNUMsUUFBcUJFLElBQWpCRCxFQUNILE9BQU9BLEVBQWFsSyxRQUdyQixJQUFJb0ssRUFBU0wsRUFBeUJFLEdBQVksQ0FHakRqSyxRQUFTLElBT1YsT0FIQXFLLEVBQW9CSixHQUFVRyxFQUFRQSxFQUFPcEssUUFBU2dLLEdBRy9DSSxFQUFPcEssUSxNQ25CZixNQUFNc0ssRUFBWSxFQUFRLEtBQ3BCeEUsRUFBZSxFQUFRLEtBQ3ZCdkYsRUFBaUIsRUFBUSxLQUN6QkMsRUFBWSxFQUFRLEtBQzFCLE1BQ0kyRyxhQUNJdkcsS0FBSzJKLGNBQ0x6RSxFQUFheEIsV0FBV2hELFNBQ3hCZ0osRUFBVXBLLFFBQVFvQixTQUV0QjZGLHFCQUNJM0csRUFBVWUsUUFBUXNDLFNBQVN0RCxFQUFleUIsYUFBYUMsSUFBSSxVQUFZLFdBQ3ZFekIsRUFBVWUsUUFBUTBDLGFBQWExRCxFQUFleUIsYUFBYUMsSUFBSSxjQUFnQixJQUMvRXpCLEVBQVVlLFFBQVFxSCxRQUFRckksRUFBZXlCLGFBQWFDLElBQUksU0FBVyxZQUd4RXVJLE8iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93aGl0ZWJvYXJkLXY1Ly4vYm9hcmQvdHMvRHJhd2luZy50cyIsIndlYnBhY2s6Ly93aGl0ZWJvYXJkLXY1Ly4vYm9hcmQvdHMvY2FudmFzL0NhbnZhcy50cyIsIndlYnBhY2s6Ly93aGl0ZWJvYXJkLXY1Ly4vYm9hcmQvdHMvY2FudmFzL0NvbmZpZy50cyIsIndlYnBhY2s6Ly93aGl0ZWJvYXJkLXY1Ly4vYm9hcmQvdHMvY2FudmFzL01haW5DYW52YXMudHMiLCJ3ZWJwYWNrOi8vd2hpdGVib2FyZC12NS8uL2JvYXJkL3RzL3Rvb2xzL0JydXNoLnRzIiwid2VicGFjazovL3doaXRlYm9hcmQtdjUvLi9ib2FyZC90cy90b29scy9FcmFzZXIudHMiLCJ3ZWJwYWNrOi8vd2hpdGVib2FyZC12NS8uL2JvYXJkL3RzL3Rvb2xzL051bGxUb29sLnRzIiwid2VicGFjazovL3doaXRlYm9hcmQtdjUvLi9ib2FyZC90cy90b29scy9Ub29sLnRzIiwid2VicGFjazovL3doaXRlYm9hcmQtdjUvLi9ib2FyZC90cy91dGlsL0JvYXJkU3RvcmFnZS50cyIsIndlYnBhY2s6Ly93aGl0ZWJvYXJkLXY1Ly4vYm9hcmQvdHMvdXRpbC9Db250cm9sLnRzIiwid2VicGFjazovL3doaXRlYm9hcmQtdjUvLi9ib2FyZC90cy91dGlsL01vdXNlLnRzIiwid2VicGFjazovL3doaXRlYm9hcmQtdjUvLi9ib2FyZC90cy91dGlsL1BvaW50LnRzIiwid2VicGFjazovL3doaXRlYm9hcmQtdjUvLi9ib2FyZC90cy91dGlsL1Byb3BlcnRpZXMudHMiLCJ3ZWJwYWNrOi8vd2hpdGVib2FyZC12NS8uL2JvYXJkL3RzL3V0aWwvVmFsaWQudHMiLCJ3ZWJwYWNrOi8vd2hpdGVib2FyZC12NS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly93aGl0ZWJvYXJkLXY1Ly4vYm9hcmQvdHMvTWFpbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLkRyYXdpbmcgPSB2b2lkIDA7XHJcbmNvbnN0IENhbnZhc18xID0gcmVxdWlyZShcIi4vY2FudmFzL0NhbnZhc1wiKTtcclxuY29uc3QgQnJ1c2hfMSA9IHJlcXVpcmUoXCIuL3Rvb2xzL0JydXNoXCIpO1xyXG5jb25zdCBFcmFzZXJfMSA9IHJlcXVpcmUoXCIuL3Rvb2xzL0VyYXNlclwiKTtcclxuY29uc3QgTnVsbFRvb2xfMSA9IHJlcXVpcmUoXCIuL3Rvb2xzL051bGxUb29sXCIpO1xyXG5jb25zdCBCb2FyZFN0b3JhZ2VfMSA9IHJlcXVpcmUoXCIuL3V0aWwvQm9hcmRTdG9yYWdlXCIpO1xyXG5jb25zdCBDb250cm9sXzEgPSByZXF1aXJlKFwiLi91dGlsL0NvbnRyb2xcIik7XHJcbmNvbnN0IE1vdXNlXzEgPSByZXF1aXJlKFwiLi91dGlsL01vdXNlXCIpO1xyXG5jb25zdCBQcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi91dGlsL1Byb3BlcnRpZXNcIik7XHJcbmNsYXNzIERyYXdpbmcge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5kcmF3ID0gKGUpID0+IHRoaXMudG9vbC5hZGRQb2ludChNb3VzZV8xLk1vdXNlLmdldFBvc2l0aW9uKGUpKTtcclxuICAgICAgICB0aGlzLmNhbnZhcyA9IG5ldyBDYW52YXNfMS5DYW52YXMoKTtcclxuICAgICAgICB0aGlzLnRvb2wgPSBOdWxsVG9vbF8xLk51bGxUb29sLkluc3RhbmNlO1xyXG4gICAgICAgIENvbnRyb2xfMS5Db250cm9sLnNldHVwTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5hcHBlbmRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBnZXQgSW5zdGFuY2UoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2luc3RhbmNlIHx8ICh0aGlzLl9pbnN0YW5jZSA9IG5ldyB0aGlzKCkpO1xyXG4gICAgfVxyXG4gICAgYXBwZW5kTGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmRvd25cIiwgZSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChDb250cm9sXzEuQ29udHJvbC5pc0NvbnRyb2xFbGVtKGUudGFyZ2V0KSlcclxuICAgICAgICAgICAgICAgIHJldHVybjsgLy9yZXR1cm5zIGlmIGVsZW1lbnQgaXMgY29udHJvbCBlbGVtICh0b29sLCBjb2xvciBwaWNrZXIgZXRjLilcclxuICAgICAgICAgICAgdGhpcy50b29sID0gdGhpcy5jaG9vc2VUb29sKEJvYXJkU3RvcmFnZV8xLkJvYXJkU3RvcmFnZS5nZXQoXCJ0b29sXCIpLCBQcm9wZXJ0aWVzXzEuUHJvcGVydGllcy5sb2NhbCk7XHJcbiAgICAgICAgICAgIHRoaXMudG9vbC5zdGFydERyYXcoTW91c2VfMS5Nb3VzZS5nZXRQb3NpdGlvbihlKSk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcm1vdmVcIiwgdGhpcy5kcmF3LCBmYWxzZSk7XHJcbiAgICAgICAgfSwgZmFsc2UpO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsICgpID0+IHtcclxuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCB0aGlzLmRyYXcsIGZhbHNlKTtcclxuICAgICAgICAgICAgdGhpcy50b29sLmVuZERyYXcoKTtcclxuICAgICAgICAgICAgdGhpcy50b29sID0gTnVsbFRvb2xfMS5OdWxsVG9vbC5JbnN0YW5jZTtcclxuICAgICAgICB9LCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgICBjaG9vc2VUb29sKHRvb2xOYW1lLCBwcm9wZXJ0aWVzKSB7XHJcbiAgICAgICAgc3dpdGNoICh0b29sTmFtZSkge1xyXG4gICAgICAgICAgICBjYXNlIFwiYnJ1c2hcIjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQnJ1c2hfMS5CcnVzaCh0aGlzLmNhbnZhcywgcHJvcGVydGllcyk7XHJcbiAgICAgICAgICAgIGNhc2UgXCJlcmFzZXJcIjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRXJhc2VyXzEuRXJhc2VyKHRoaXMuY2FudmFzLCBwcm9wZXJ0aWVzKTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBOdWxsVG9vbF8xLk51bGxUb29sLkluc3RhbmNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5leHBvcnRzLkRyYXdpbmcgPSBEcmF3aW5nO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLkNhbnZhcyA9IHZvaWQgMDtcclxuY29uc3QgQ29uZmlnXzEgPSByZXF1aXJlKFwiLi9Db25maWdcIik7XHJcbmNsYXNzIENhbnZhcyB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLl9jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgIHRoaXMuX2NhbnZhcy53aWR0aCA9IHdpbmRvdy5zY3JlZW4uYXZhaWxXaWR0aDtcclxuICAgICAgICB0aGlzLl9jYW52YXMuaGVpZ2h0ID0gd2luZG93LnNjcmVlbi5hdmFpbEhlaWdodDtcclxuICAgICAgICB0aGlzLl9jdHggPSB0aGlzLl9jYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgICAgIHRoaXMuc2V0UHJvcGVydGllcygpO1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5fY2FudmFzKTtcclxuICAgIH1cclxuICAgIHNldFByb3BlcnRpZXMoKSB7XHJcbiAgICAgICAgdGhpcy5jdHgubGluZUpvaW4gPSBDb25maWdfMS5Db25maWcubGluZUpvaW47XHJcbiAgICAgICAgdGhpcy5jdHgubGluZUNhcCA9IENvbmZpZ18xLkNvbmZpZy5saW5lQ2FwO1xyXG4gICAgfVxyXG4gICAgc2V0Q29sb3IoY29sb3IpIHtcclxuICAgICAgICB0aGlzLl9jdHguc3Ryb2tlU3R5bGUgPSBjb2xvcjtcclxuICAgICAgICB0aGlzLl9jdHguZmlsbFN0eWxlID0gY29sb3I7XHJcbiAgICB9XHJcbiAgICBzZXRMaW5lV2lkdGgobGluZVdpZHRoKSB7XHJcbiAgICAgICAgdGhpcy5fY3R4LmxpbmVXaWR0aCA9IGxpbmVXaWR0aDtcclxuICAgIH1cclxuICAgIGNsZWFyKCkge1xyXG4gICAgICAgIHRoaXMuX2N0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5fY2FudmFzLndpZHRoLCB0aGlzLl9jYW52YXMuaGVpZ2h0KTtcclxuICAgIH1cclxuICAgIGdldCBjYW52YXMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhbnZhcztcclxuICAgIH1cclxuICAgIGdldCBjdHgoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N0eDtcclxuICAgIH1cclxufVxyXG5leHBvcnRzLkNhbnZhcyA9IENhbnZhcztcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5Db25maWcgPSB2b2lkIDA7XHJcbmNvbnN0IENvbmZpZyA9IHtcclxuICAgIGxpbmVKb2luOiBcInJvdW5kXCIsXHJcbiAgICBsaW5lQ2FwOiBcInJvdW5kXCIsXHJcbiAgICBjYW5EcmF3OiBmYWxzZSxcclxufTtcclxuZXhwb3J0cy5Db25maWcgPSBDb25maWc7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuTWFpbkNhbnZhcyA9IHZvaWQgMDtcclxuY29uc3QgQ2FudmFzXzEgPSByZXF1aXJlKFwiLi9DYW52YXNcIik7XHJcbmNvbnN0IEJvYXJkU3RvcmFnZV8xID0gcmVxdWlyZShcIi4uL3V0aWwvQm9hcmRTdG9yYWdlXCIpO1xyXG5jbGFzcyBNYWluQ2FudmFzIGV4dGVuZHMgQ2FudmFzXzEuQ2FudmFzIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5kcmF3V2hpdGVCYWNrZ3JvdW5kKCk7XHJcbiAgICAgICAgdGhpcy5kcmF3RnJvbVN0b3JhZ2UoKTtcclxuICAgICAgICB0aGlzLnNlbmRUb0JhY2soKTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBnZXQgSW5zdGFuY2UoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2luc3RhbmNlIHx8ICh0aGlzLl9pbnN0YW5jZSA9IG5ldyB0aGlzKCkpO1xyXG4gICAgfVxyXG4gICAgZHJhd0Zyb21TdG9yYWdlKCkge1xyXG4gICAgICAgIGxldCBpbWdTcmMgPSBCb2FyZFN0b3JhZ2VfMS5Cb2FyZFN0b3JhZ2UuZ2V0KFwiaW1nXCIpO1xyXG4gICAgICAgIGlmICghaW1nU3JjKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgbGV0IGltZyA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgIGltZy5zcmMgPSBpbWdTcmM7XHJcbiAgICAgICAgaW1nLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsICgpID0+IHRoaXMuY3R4LmRyYXdJbWFnZShpbWcsIDAsIDApKTtcclxuICAgIH1cclxuICAgIGRyYXdXaGl0ZUJhY2tncm91bmQoKSB7XHJcbiAgICAgICAgbGV0IHByZXZGaWxsU3R5bGUgPSB0aGlzLmN0eC5maWxsU3R5bGU7XHJcbiAgICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gJ3doaXRlJztcclxuICAgICAgICB0aGlzLmN0eC5maWxsUmVjdCgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICB0aGlzLmN0eC5maWxsU3R5bGUgPSBwcmV2RmlsbFN0eWxlO1xyXG4gICAgfVxyXG4gICAgc2VuZFRvQmFjaygpIHtcclxuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS56SW5kZXggPSBcIi0xMDAwXCI7XHJcbiAgICB9XHJcbiAgICBkcmF3SW1hZ2UoY2FudmFzKSB7XHJcbiAgICAgICAgdGhpcy5jdHguZHJhd0ltYWdlKGNhbnZhcywgMCwgMCk7XHJcbiAgICB9XHJcbiAgICBzYXZlSW5TdG9yYWdlKCkge1xyXG4gICAgICAgIGxldCBpbWcgPSB0aGlzLmdldEltZ1NyYygpO1xyXG4gICAgICAgIEJvYXJkU3RvcmFnZV8xLkJvYXJkU3RvcmFnZS5zZXQoXCJpbWdcIiwgaW1nKTtcclxuICAgIH1cclxuICAgIGdldEltZ1NyYygpIHtcclxuICAgICAgICBsZXQgaW1nZCA9IHRoaXMuY3R4LmdldEltYWdlRGF0YSgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICB0aGlzLmN0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgdGhpcy5jdHgucHV0SW1hZ2VEYXRhKGltZ2QsIDAsIDApO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNhbnZhcy50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIik7XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0cy5NYWluQ2FudmFzID0gTWFpbkNhbnZhcztcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5CcnVzaCA9IHZvaWQgMDtcclxuY29uc3QgVG9vbF8xID0gcmVxdWlyZShcIi4vVG9vbFwiKTtcclxuY2xhc3MgQnJ1c2ggZXh0ZW5kcyBUb29sXzEuVG9vbCB7XHJcbiAgICBwcmVwYXJlKCkge1xyXG4gICAgICAgIHRoaXMuY2FudmFzLnNldENvbG9yKHRoaXMucHJvcGVydGllcy5jb2xvcik7XHJcbiAgICAgICAgdGhpcy5jYW52YXMuc2V0TGluZVdpZHRoKHRoaXMucHJvcGVydGllcy5saW5lV2lkdGgpO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydHMuQnJ1c2ggPSBCcnVzaDtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5FcmFzZXIgPSB2b2lkIDA7XHJcbmNvbnN0IFRvb2xfMSA9IHJlcXVpcmUoXCIuL1Rvb2xcIik7XHJcbmNsYXNzIEVyYXNlciBleHRlbmRzIFRvb2xfMS5Ub29sIHtcclxuICAgIHByZXBhcmUoKSB7XHJcbiAgICAgICAgdGhpcy5jYW52YXMuc2V0Q29sb3IoXCIjZmZmZmZmXCIpO1xyXG4gICAgICAgIHRoaXMuY2FudmFzLnNldExpbmVXaWR0aCh0aGlzLnByb3BlcnRpZXMubGluZVdpZHRoKTtcclxuICAgIH1cclxufVxyXG5leHBvcnRzLkVyYXNlciA9IEVyYXNlcjtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5OdWxsVG9vbCA9IHZvaWQgMDtcclxuY29uc3QgUHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL3V0aWwvUHJvcGVydGllc1wiKTtcclxuY29uc3QgVG9vbF8xID0gcmVxdWlyZShcIi4vVG9vbFwiKTtcclxuY2xhc3MgTnVsbFRvb2wgZXh0ZW5kcyBUb29sXzEuVG9vbCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcih7fSwgUHJvcGVydGllc18xLlByb3BlcnRpZXMubG9jYWwpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGdldCBJbnN0YW5jZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faW5zdGFuY2UgfHwgKHRoaXMuX2luc3RhbmNlID0gbmV3IHRoaXMoKSk7XHJcbiAgICB9XHJcbiAgICAvL292ZXJ3cml0ZVxyXG4gICAgYWRkUG9pbnQoKSB7IH1cclxuICAgIDtcclxuICAgIHN0YXJ0RHJhdygpIHsgfVxyXG4gICAgO1xyXG4gICAgZW5kRHJhdygpIHsgfVxyXG4gICAgO1xyXG4gICAgcHJlcGFyZSgpIHsgfVxyXG4gICAgO1xyXG59XHJcbmV4cG9ydHMuTnVsbFRvb2wgPSBOdWxsVG9vbDtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5Ub29sID0gdm9pZCAwO1xyXG5jb25zdCBNYWluQ2FudmFzXzEgPSByZXF1aXJlKFwiLi4vY2FudmFzL01haW5DYW52YXNcIik7XHJcbmNsYXNzIFRvb2wge1xyXG4gICAgY29uc3RydWN0b3IoY2FudmFzLCBwcm9wZXJ0aWVzKSB7XHJcbiAgICAgICAgdGhpcy5jYW52YXMgPSBjYW52YXM7XHJcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzID0gcHJvcGVydGllcztcclxuICAgICAgICB0aGlzLnBvaW50cyA9IFtdO1xyXG4gICAgfVxyXG4gICAgYWRkUG9pbnQocG9pbnQpIHtcclxuICAgICAgICB0aGlzLnBvaW50cy5wdXNoKHBvaW50KTtcclxuICAgICAgICB0aGlzLmRyYXcoKTtcclxuICAgIH1cclxuICAgIHN0YXJ0RHJhdyhwb2ludCkge1xyXG4gICAgICAgIHRoaXMucHJlcGFyZSgpO1xyXG4gICAgICAgIHRoaXMuYWRkUG9pbnQocG9pbnQpO1xyXG4gICAgfVxyXG4gICAgO1xyXG4gICAgZHJhdygpIHtcclxuICAgICAgICBpZiAodGhpcy5wb2ludHMubGVuZ3RoIDwgMykge1xyXG4gICAgICAgICAgICBsZXQgYiA9IHRoaXMucG9pbnRzWzBdO1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5jdHguYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmN0eC5hcmMoYi54LCBiLnksIHRoaXMuY2FudmFzLmN0eC5saW5lV2lkdGggLyAyLCAwLCBNYXRoLlBJICogMiwgITApO1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5jdHguZmlsbCgpO1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5jdHguY2xvc2VQYXRoKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYW52YXMuY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLmNhbnZhcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmNhbnZhcy5oZWlnaHQpO1xyXG4gICAgICAgIHRoaXMuY2FudmFzLmN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICB0aGlzLmNhbnZhcy5jdHgubW92ZVRvKHRoaXMucG9pbnRzWzBdLngsIHRoaXMucG9pbnRzWzBdLnkpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgdGhpcy5wb2ludHMubGVuZ3RoIC0gMjsgaSsrKSB7IC8vVGhpcyBtYWtlIGxpbmUgc21vb3RoZXJcclxuICAgICAgICAgICAgbGV0IGMgPSAodGhpcy5wb2ludHNbaV0ueCArIHRoaXMucG9pbnRzW2kgKyAxXS54KSAvIDI7XHJcbiAgICAgICAgICAgIGxldCBkID0gKHRoaXMucG9pbnRzW2ldLnkgKyB0aGlzLnBvaW50c1tpICsgMV0ueSkgLyAyO1xyXG4gICAgICAgICAgICB0aGlzLmNhbnZhcy5jdHgucXVhZHJhdGljQ3VydmVUbyh0aGlzLnBvaW50c1tpXS54LCB0aGlzLnBvaW50c1tpXS55LCBjLCBkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGkgPSB0aGlzLnBvaW50cy5sZW5ndGggLSAyO1xyXG4gICAgICAgIHRoaXMuY2FudmFzLmN0eC5xdWFkcmF0aWNDdXJ2ZVRvKHRoaXMucG9pbnRzW2ldLngsIHRoaXMucG9pbnRzW2ldLnksIHRoaXMucG9pbnRzW2kgKyAxXS54LCB0aGlzLnBvaW50c1tpICsgMV0ueSk7XHJcbiAgICAgICAgdGhpcy5jYW52YXMuY3R4LnN0cm9rZSgpO1xyXG4gICAgfVxyXG4gICAgO1xyXG4gICAgZW5kRHJhdygpIHtcclxuICAgICAgICBNYWluQ2FudmFzXzEuTWFpbkNhbnZhcy5JbnN0YW5jZS5kcmF3SW1hZ2UodGhpcy5jYW52YXMuY2FudmFzKTtcclxuICAgICAgICBNYWluQ2FudmFzXzEuTWFpbkNhbnZhcy5JbnN0YW5jZS5zYXZlSW5TdG9yYWdlKCk7XHJcbiAgICAgICAgdGhpcy5jYW52YXMuY2xlYXIoKTtcclxuICAgIH1cclxuICAgIDtcclxufVxyXG5leHBvcnRzLlRvb2wgPSBUb29sO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5leHBvcnRzLkJvYXJkU3RvcmFnZSA9IHZvaWQgMDtcclxuY29uc3QgVmFsaWRfMSA9IHJlcXVpcmUoXCIuL1ZhbGlkXCIpO1xyXG5jbGFzcyBCb2FyZFN0b3JhZ2Uge1xyXG4gICAgc3RhdGljIHNldChrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gXCJvYmplY3RcIilcclxuICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKTtcclxuICAgICAgICB2YWx1ZSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcclxuICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKGtleSwgdmFsdWUpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGdldChrZXkpIHtcclxuICAgICAgICBsZXQgaXRlbSA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oa2V5KTtcclxuICAgICAgICBpZiAoIVZhbGlkXzEuVmFsaWQuaXNKU09OKGl0ZW0pKVxyXG4gICAgICAgICAgICByZXR1cm4gaXRlbTtcclxuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShpdGVtKTtcclxuICAgIH1cclxufVxyXG5leHBvcnRzLkJvYXJkU3RvcmFnZSA9IEJvYXJkU3RvcmFnZTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5Db250cm9sID0gdm9pZCAwO1xyXG5jb25zdCBCb2FyZFN0b3JhZ2VfMSA9IHJlcXVpcmUoXCIuL0JvYXJkU3RvcmFnZVwiKTtcclxuY2xhc3MgQ29udHJvbCB7XHJcbiAgICBzdGF0aWMgaXNDb250cm9sRWxlbShlbGVtKSB7XHJcbiAgICAgICAgbGV0IGlzVG9vbEVsZW0gPSBmYWxzZTtcclxuICAgICAgICBBcnJheS5mcm9tKHRoaXMudG9vbHMuY2hpbGRyZW4pLmZvckVhY2goY2hpbGQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoY2hpbGQuY2xhc3NOYW1lID09IGVsZW0uY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBpc1Rvb2xFbGVtID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiAoaXNUb29sRWxlbSB8fCBlbGVtLmNsYXNzTmFtZSA9PSB0aGlzLmNvbG9yT3V0cHV0LmNsYXNzTmFtZSB8fCBlbGVtLmNsYXNzTmFtZSA9PSB0aGlzLmNvbG9ySW5wdXQuY2xhc3NOYW1lIHx8IGVsZW0uY2xhc3NOYW1lID09IHRoaXMubGluZVdpZHRoSW5wdXQuY2xhc3NOYW1lIHx8IGVsZW0uY2xhc3NOYW1lID09IHRoaXMubGluZVdpZHRoT3V0cHV0LmNsYXNzTmFtZSB8fCBlbGVtLmNsYXNzTmFtZSA9PSB0aGlzLmRvd25sb2FkLmNsYXNzTmFtZSk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgc2V0dXBMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5saW5lV2lkdGhJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZSA9PiB0aGlzLnNldExpbmVXaWR0aCgrZS50YXJnZXQudmFsdWUpKTtcclxuICAgICAgICB0aGlzLmNvbG9ySW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGUgPT4gdGhpcy5zZXRDb2xvcihlLnRhcmdldC52YWx1ZSkpO1xyXG4gICAgICAgIHRoaXMudG9vbHMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGUgPT4gdGhpcy5zZXRUb29sKGUudGFyZ2V0LmNsYXNzTmFtZSkpO1xyXG4gICAgICAgIHRoaXMuZG93bmxvYWQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuZG93bmxvYWRJbWFnZSgpKTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBzZXRDb2xvcihjb2xvcikge1xyXG4gICAgICAgIEJvYXJkU3RvcmFnZV8xLkJvYXJkU3RvcmFnZS5zZXQoXCJjb2xvclwiLCBjb2xvcik7XHJcbiAgICAgICAgdGhpcy5jb2xvck91dHB1dC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcclxuICAgIH1cclxuICAgIDtcclxuICAgIHN0YXRpYyBzZXRMaW5lV2lkdGgoc2l6ZSkge1xyXG4gICAgICAgIEJvYXJkU3RvcmFnZV8xLkJvYXJkU3RvcmFnZS5zZXQoXCJsaW5lV2lkdGhcIiwgc2l6ZS50b1N0cmluZygpKTtcclxuICAgICAgICB0aGlzLmxpbmVXaWR0aE91dHB1dC52YWx1ZSA9IHNpemUudG9TdHJpbmcoKTtcclxuICAgICAgICB0aGlzLmxpbmVXaWR0aElucHV0LnZhbHVlID0gc2l6ZS50b1N0cmluZygpO1xyXG4gICAgfVxyXG4gICAgO1xyXG4gICAgc3RhdGljIHNldFRvb2wodG9vbCkge1xyXG4gICAgICAgIGlmICh0b29sID09IFwidG9vbHNcIilcclxuICAgICAgICAgICAgcmV0dXJuOyAvLyBJZiB1c2VyIGNsaWNrIG9uIG5hdiAoIG5vdCBvbiB0b29sIGljb24gKSBqdXN0IHJldHVybi5cclxuICAgICAgICBCb2FyZFN0b3JhZ2VfMS5Cb2FyZFN0b3JhZ2Uuc2V0KFwidG9vbFwiLCB0b29sKTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBkb3dubG9hZEltYWdlKCkge1xyXG4gICAgICAgIGxldCBpbWFnZSA9IEJvYXJkU3RvcmFnZV8xLkJvYXJkU3RvcmFnZS5nZXQoXCJpbWdcIik7XHJcbiAgICAgICAgdGhpcy5kb3dubG9hZC5ocmVmID0gaW1hZ2U7XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0cy5Db250cm9sID0gQ29udHJvbDtcclxuQ29udHJvbC5jb2xvck91dHB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjb2xvci1sYWJlbC1lbGVtZW50XCIpWzBdO1xyXG5Db250cm9sLmNvbG9ySW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiY29sb3JcIilbMF07XHJcbkNvbnRyb2wubGluZVdpZHRoT3V0cHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInBhaW50LXNpemUtb3V0XCIpWzBdO1xyXG5Db250cm9sLmxpbmVXaWR0aElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInBhaW50LXNpemUtaW5cIilbMF07XHJcbkNvbnRyb2wudG9vbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwidG9vbHNcIilbMF07XHJcbkNvbnRyb2wuZG93bmxvYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiZG93bmxvYWRcIilbMF07XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuTW91c2UgPSB2b2lkIDA7XHJcbmNvbnN0IFBvaW50XzEgPSByZXF1aXJlKFwiLi9Qb2ludFwiKTtcclxuY2xhc3MgTW91c2Uge1xyXG4gICAgc3RhdGljIGdldFBvc2l0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQb2ludF8xLlBvaW50KGV2ZW50LnBhZ2VYLCBldmVudC5wYWdlWSk7XHJcbiAgICB9XHJcbiAgICBzdGF0aWMgc2V0Q3Vyc29yU3R5bGUoc3R5bGUpIHtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9IHN0eWxlO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydHMuTW91c2UgPSBNb3VzZTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuZXhwb3J0cy5Qb2ludCA9IHZvaWQgMDtcclxuY2xhc3MgUG9pbnQge1xyXG4gICAgY29uc3RydWN0b3IoeCwgeSkge1xyXG4gICAgICAgIHRoaXMuX3ggPSB4O1xyXG4gICAgICAgIHRoaXMuX3kgPSB5O1xyXG4gICAgfVxyXG4gICAgZ2V0IHgoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3g7XHJcbiAgICB9XHJcbiAgICBnZXQgeSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5feTtcclxuICAgIH1cclxufVxyXG5leHBvcnRzLlBvaW50ID0gUG9pbnQ7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuUHJvcGVydGllcyA9IHZvaWQgMDtcclxuY29uc3QgQm9hcmRTdG9yYWdlXzEgPSByZXF1aXJlKFwiLi9Cb2FyZFN0b3JhZ2VcIik7XHJcbmNsYXNzIFByb3BlcnRpZXMge1xyXG4gICAgY29uc3RydWN0b3IobGluZVdpZHRoLCBjb2xvcikge1xyXG4gICAgICAgIHRoaXMuX2xpbmVXaWR0aCA9IGxpbmVXaWR0aDtcclxuICAgICAgICB0aGlzLl9jb2xvciA9IGNvbG9yO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGdldCBsb2NhbCgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IHRoaXMoK0JvYXJkU3RvcmFnZV8xLkJvYXJkU3RvcmFnZS5nZXQoXCJsaW5lV2lkdGhcIiksIEJvYXJkU3RvcmFnZV8xLkJvYXJkU3RvcmFnZS5nZXQoXCJjb2xvclwiKSk7XHJcbiAgICB9XHJcbiAgICBnZXQgbGluZVdpZHRoKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9saW5lV2lkdGg7XHJcbiAgICB9XHJcbiAgICBnZXQgY29sb3IoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbG9yO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydHMuUHJvcGVydGllcyA9IFByb3BlcnRpZXM7XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmV4cG9ydHMuVmFsaWQgPSB2b2lkIDA7XHJcbmNsYXNzIFZhbGlkIHtcclxuICAgIHN0YXRpYyBpc0pTT04ocykge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIEpTT04ucGFyc2Uocyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0cy5WYWxpZCA9IFZhbGlkO1xyXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuY29uc3QgRHJhd2luZ18xID0gcmVxdWlyZShcIi4vRHJhd2luZ1wiKTtcclxuY29uc3QgTWFpbkNhbnZhc18xID0gcmVxdWlyZShcIi4vY2FudmFzL01haW5DYW52YXNcIik7XHJcbmNvbnN0IEJvYXJkU3RvcmFnZV8xID0gcmVxdWlyZShcIi4vdXRpbC9Cb2FyZFN0b3JhZ2VcIik7XHJcbmNvbnN0IENvbnRyb2xfMSA9IHJlcXVpcmUoXCIuL3V0aWwvQ29udHJvbFwiKTtcclxuY2xhc3MgTWFpbiB7XHJcbiAgICBzdGF0aWMgcnVuKCkge1xyXG4gICAgICAgIHRoaXMuc2V0dXBDb25maWcoKTtcclxuICAgICAgICBNYWluQ2FudmFzXzEuTWFpbkNhbnZhcy5JbnN0YW5jZTtcclxuICAgICAgICBEcmF3aW5nXzEuRHJhd2luZy5JbnN0YW5jZTtcclxuICAgIH1cclxuICAgIHN0YXRpYyBzZXR1cENvbmZpZygpIHtcclxuICAgICAgICBDb250cm9sXzEuQ29udHJvbC5zZXRDb2xvcihCb2FyZFN0b3JhZ2VfMS5Cb2FyZFN0b3JhZ2UuZ2V0KFwiY29sb3JcIikgfHwgXCIjMDAwMDAwXCIpO1xyXG4gICAgICAgIENvbnRyb2xfMS5Db250cm9sLnNldExpbmVXaWR0aChCb2FyZFN0b3JhZ2VfMS5Cb2FyZFN0b3JhZ2UuZ2V0KFwibGluZVdpZHRoXCIpIHx8IDEwKTtcclxuICAgICAgICBDb250cm9sXzEuQ29udHJvbC5zZXRUb29sKEJvYXJkU3RvcmFnZV8xLkJvYXJkU3RvcmFnZS5nZXQoXCJ0b29sXCIpIHx8IFwiYnJ1c2hcIik7XHJcbiAgICB9XHJcbn1cclxuTWFpbi5ydW4oKTtcclxuIl0sIm5hbWVzIjpbIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiRHJhd2luZyIsIkNhbnZhc18xIiwiQnJ1c2hfMSIsIkVyYXNlcl8xIiwiTnVsbFRvb2xfMSIsIkJvYXJkU3RvcmFnZV8xIiwiQ29udHJvbF8xIiwiTW91c2VfMSIsIlByb3BlcnRpZXNfMSIsImNvbnN0cnVjdG9yIiwidGhpcyIsImRyYXciLCJlIiwidG9vbCIsImFkZFBvaW50IiwiTW91c2UiLCJnZXRQb3NpdGlvbiIsImNhbnZhcyIsIkNhbnZhcyIsIk51bGxUb29sIiwiSW5zdGFuY2UiLCJDb250cm9sIiwic2V0dXBMaXN0ZW5lcnMiLCJhcHBlbmRMaXN0ZW5lcnMiLCJfaW5zdGFuY2UiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwiaXNDb250cm9sRWxlbSIsInRhcmdldCIsImNob29zZVRvb2wiLCJCb2FyZFN0b3JhZ2UiLCJnZXQiLCJQcm9wZXJ0aWVzIiwibG9jYWwiLCJzdGFydERyYXciLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZW5kRHJhdyIsInRvb2xOYW1lIiwicHJvcGVydGllcyIsIkJydXNoIiwiRXJhc2VyIiwiQ29uZmlnXzEiLCJfY2FudmFzIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwid2lkdGgiLCJzY3JlZW4iLCJhdmFpbFdpZHRoIiwiaGVpZ2h0IiwiYXZhaWxIZWlnaHQiLCJfY3R4IiwiZ2V0Q29udGV4dCIsInNldFByb3BlcnRpZXMiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJjdHgiLCJsaW5lSm9pbiIsIkNvbmZpZyIsImxpbmVDYXAiLCJzZXRDb2xvciIsImNvbG9yIiwic3Ryb2tlU3R5bGUiLCJmaWxsU3R5bGUiLCJzZXRMaW5lV2lkdGgiLCJsaW5lV2lkdGgiLCJjbGVhciIsImNsZWFyUmVjdCIsImNhbkRyYXciLCJNYWluQ2FudmFzIiwic3VwZXIiLCJkcmF3V2hpdGVCYWNrZ3JvdW5kIiwiZHJhd0Zyb21TdG9yYWdlIiwic2VuZFRvQmFjayIsImltZ1NyYyIsImltZyIsIkltYWdlIiwic3JjIiwiZHJhd0ltYWdlIiwicHJldkZpbGxTdHlsZSIsImZpbGxSZWN0Iiwic3R5bGUiLCJ6SW5kZXgiLCJzYXZlSW5TdG9yYWdlIiwiZ2V0SW1nU3JjIiwic2V0IiwiaW1nZCIsImdldEltYWdlRGF0YSIsInB1dEltYWdlRGF0YSIsInRvRGF0YVVSTCIsIlRvb2xfMSIsIlRvb2wiLCJwcmVwYXJlIiwiTWFpbkNhbnZhc18xIiwicG9pbnRzIiwicG9pbnQiLCJwdXNoIiwibGVuZ3RoIiwiYiIsImJlZ2luUGF0aCIsImFyYyIsIngiLCJ5IiwiTWF0aCIsIlBJIiwiZmlsbCIsImNsb3NlUGF0aCIsIm1vdmVUbyIsImkiLCJjIiwiZCIsInF1YWRyYXRpY0N1cnZlVG8iLCJzdHJva2UiLCJWYWxpZF8xIiwic3RhdGljIiwia2V5Iiwic2Vzc2lvblN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsIml0ZW0iLCJnZXRJdGVtIiwiVmFsaWQiLCJpc0pTT04iLCJwYXJzZSIsImVsZW0iLCJpc1Rvb2xFbGVtIiwiQXJyYXkiLCJmcm9tIiwidG9vbHMiLCJjaGlsZHJlbiIsImZvckVhY2giLCJjaGlsZCIsImNsYXNzTmFtZSIsImNvbG9yT3V0cHV0IiwiY29sb3JJbnB1dCIsImxpbmVXaWR0aElucHV0IiwibGluZVdpZHRoT3V0cHV0IiwiZG93bmxvYWQiLCJzZXRUb29sIiwiZG93bmxvYWRJbWFnZSIsImJhY2tncm91bmRDb2xvciIsInNpemUiLCJ0b1N0cmluZyIsImltYWdlIiwiaHJlZiIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJQb2ludF8xIiwiZXZlbnQiLCJQb2ludCIsInBhZ2VYIiwicGFnZVkiLCJjdXJzb3IiLCJfeCIsIl95IiwiX2xpbmVXaWR0aCIsIl9jb2xvciIsInMiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiRHJhd2luZ18xIiwic2V0dXBDb25maWciLCJydW4iXSwic291cmNlUm9vdCI6IiJ9